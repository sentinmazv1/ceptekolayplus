            {/* SMS Modal */}
            {isSmsModalOpen && (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg flex flex-col p-6 animate-in fade-in zoom-in duration-200">
                        <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <MessageSquare className="w-5 h-5 text-green-600" />
                            SMS Gönder ({data.telefon})
                        </h3>
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-1">Mesaj İçeriği</label>
                            <textarea
                                className="w-full h-32 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm"
                                placeholder="Mesajınızı buraya yazın..."
                                value={smsMessage}
                                onChange={(e) => setSmsMessage(e.target.value)}
                            />
                            <div className="text-right text-xs text-gray-500 mt-1">
                                {smsMessage.length} karakter - {Math.ceil(smsMessage.length / 160)} SMS
                            </div>
                        </div>

                        {/* Template Shortcuts */}
                        <div className="mb-4 flex flex-col gap-3 max-h-60 overflow-y-auto pr-1">
                            <div className="text-xs font-semibold text-gray-500 border-b pb-1">Tanışma & Süreç</div>
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={() => setSmsMessage(`Sayın ${data.ad_soyad}, paylaştığınız bilgiler için teşekkür ederiz. Başvurunuz değerlendirme aşamasında olup, en kısa sürede size dönüş yapılacaktır. İlginiz için teşekkürler. CEPTE KOLAY`)}
                                    className="text-xs bg-cyan-50 border border-cyan-200 hover:bg-cyan-100 px-2 py-1 rounded text-cyan-700 transition"
                                >
                                    Başvuru Alındı
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Müjde! ${data.ad_soyad}, başvurunuz ${data.kredi_limiti || 'belirlenen'} TL limit ile ONAYLANMISTIR! Urununuzu teslim almak icin sizi en kisa surede magazamiza bekliyoruz. Simdiden iyi gunlerde kullanin. CEPTE KOLAY`)}
                                    className="text-xs bg-green-50 border border-green-200 hover:bg-green-100 px-2 py-1 rounded text-green-700 transition"
                                >
                                    Onaylandı
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Değerli Müşterimiz ${data.ad_soyad}, başvurunuzun olumlu sonuçlanabilmesi için kefil desteğine ihtiyaç duyulmuştur. Detaylı bilgi için 0551 349 6735 numaralı hattımızdan bize ulaşabilir veya mağazamızı ziyaret edebilirsiniz. CEPTE KOLAY`)}
                                    className="text-xs bg-orange-50 border border-orange-200 hover:bg-orange-100 px-2 py-1 rounded text-orange-700 transition"
                                >
                                    Kefil İstendi
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Sayın ${data.ad_soyad}, başvurunuzla ilgili size ulaşmaya çalıştık ancak ulaşamadık. Müsait olduğunuzda 0551 349 6735 numaramızdan veya WhatsApp hattımızdan bize dönüş yapmanızı rica ederiz. CEPTE KOLAY`)}
                                    className="text-xs bg-gray-50 border border-gray-200 hover:bg-gray-100 px-2 py-1 rounded text-gray-700 transition"
                                >
                                    Ulaşılamadı
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Sayın ${data.ad_soyad}, başvurunuzu tamamlayabilmemiz için bazı eksik evraklarınız bulunmaktadır. 0551 349 6735 WhatsApp hattımızdan bilgi alarak işlemlerinizi hızlandırabilirsiniz. CEPTE KOLAY`)}
                                    className="text-xs bg-blue-50 border border-blue-200 hover:bg-blue-100 px-2 py-1 rounded text-blue-700 transition"
                                >
                                    Eksik Evrak
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Sayın ${data.ad_soyad}, başvurunuzla ilgili işlemler durdurulmuş ve kaydınız iptal edilmiştir. İhtiyaçlarınız için kapımız size her zaman açık. CEPTE KOLAY`)}
                                    className="text-xs bg-red-50 border border-red-200 hover:bg-red-100 px-2 py-1 rounded text-red-700 transition"
                                >
                                    İptal
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Sayın ${data.ad_soyad}, ${data.talep_edilen_urun || 'Cihaz'} urununuz teslim edilmistir. IMEI: ${data.urun_imei || '...'}, Seri No: ${data.urun_seri_no || '...'}. Iyi gunlerde kullanmanizi dileriz. CEPTE KOLAY`)}
                                    className="text-xs bg-indigo-50 border border-indigo-200 hover:bg-indigo-100 px-2 py-1 rounded text-indigo-700 transition"
                                >
                                    Teslim Edildi
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Magaza Konumumuz: https://maps.app.goo.gl/VTBYugiDdTCAbnwB6 CEPTE KOLAY`)}
                                    className="text-xs bg-purple-50 border border-purple-200 hover:bg-purple-100 px-2 py-1 rounded text-purple-700 transition"
                                >
                                    Konum
                                </button>
                                <button
                                    onClick={() => setSmsMessage(`Odeme yapabileceginiz IBAN bilgimiz: TR58 0001 0008 0498 1915 2750 01 - Alici: Cepte Kolay. CEPTE KOLAY`)}
                                    className="text-xs bg-teal-50 border border-teal-200 hover:bg-teal-100 px-2 py-1 rounded text-teal-700 transition"
                                >
                                    IBAN
                                </button>
                            </div>
                        </div>

                        <div className="flex justify-end gap-2">
                            <Button variant="ghost" onClick={() => setIsSmsModalOpen(false)}>İptal</Button>
                            <Button onClick={handleSendSMS} isLoading={smsLoading} className="bg-green-600 hover:bg-green-700 text-white">
                                Gönder
                            </Button>
                        </div>
                    </div>
                </div>
            )}

            {/* WhatsApp Modal */}
            {isWhatsAppModalOpen && (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg flex flex-col p-6 animate-in fade-in zoom-in duration-200">
                        <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <MessageSquare className="w-5 h-5 text-green-600" />
                            WhatsApp Gönder ({data.telefon})
                        </h3>
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-1">Mesaj İçeriği</label>
                            <textarea
                                className="w-full h-32 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-sm"
                                placeholder="Mesajınızı buraya yazın..."
                                value={whatsAppMessage}
                                onChange={(e) => setWhatsAppMessage(e.target.value)}
                            />
                            <div className="text-right text-xs text-gray-500 mt-1">
                                {whatsAppMessage.length} karakter
                            </div>
                        </div>

                        {/* Template Shortcuts */}
                        <div className="mb-4 flex flex-col gap-3 max-h-60 overflow-y-auto pr-1">
                            <div className="text-xs font-semibold text-gray-500 border-b pb-1">Tanışma & Süreç</div>
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.WELCOME(data.ad_soyad))}
                                    className="text-xs bg-cyan-50 border border-cyan-200 hover:bg-cyan-100 px-2 py-1 rounded text-cyan-700 transition"
                                >
                                    1. Karşılama
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.PROCESS_INFO())}
                                    className="text-xs bg-cyan-50 border border-cyan-200 hover:bg-cyan-100 px-2 py-1 rounded text-cyan-700 transition"
                                >
                                    2. Süreç Anlatımı
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.CRITICAL_WARNING())}
                                    className="text-xs bg-orange-50 border border-orange-200 hover:bg-orange-100 px-2 py-1 rounded text-orange-700 transition"
                                >
                                    3. Uyarı (TC/Şifre)
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.CONFIRMATION())}
                                    className="text-xs bg-cyan-50 border border-cyan-200 hover:bg-cyan-100 px-2 py-1 rounded text-cyan-700 transition"
                                >
                                    4. Onay Alma
                                </button>
                            </div>

                            <div className="text-xs font-semibold text-gray-500 border-b pb-1">Kontrol & Sonuç</div>
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.REQUEST_ID_PASS())}
                                    className="text-xs bg-blue-50 border border-blue-200 hover:bg-blue-100 px-2 py-1 rounded text-blue-700 transition"
                                >
                                    5. Bilgi İsteme
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.CHECK_STARTED())}
                                    className="text-xs bg-blue-50 border border-blue-200 hover:bg-blue-100 px-2 py-1 rounded text-blue-700 transition"
                                >
                                    6. Kontrol Başladı
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.POSITIVE_RESULT(data.ad_soyad, data.kredi_limiti || '...'))}
                                    className="text-xs bg-green-50 border border-green-200 hover:bg-green-100 px-2 py-1 rounded text-green-700 transition"
                                >
                                    7. Olumlu Sonuç
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.NEGATIVE_RESULT())}
                                    className="text-xs bg-red-50 border border-red-200 hover:bg-red-100 px-2 py-1 rounded text-red-700 transition"
                                >
                                    12. Olumsuz Sonuç
                                </button>
                            </div>

                            <div className="text-xs font-semibold text-gray-500 border-b pb-1">Kapanış & Diğer</div>
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.CALL_PERMISSION())}
                                    className="text-xs bg-purple-50 border border-purple-200 hover:bg-purple-100 px-2 py-1 rounded text-purple-700 transition"
                                >
                                    8. Arama İzni
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.REFUSED_TO_GIVE_INFO())}
                                    className="text-xs bg-gray-50 border border-gray-200 hover:bg-gray-100 px-2 py-1 rounded text-gray-700 transition"
                                >
                                    9. Bilgi Vermeyen
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.NO_RESPONSE_24H(data.ad_soyad))}
                                    className="text-xs bg-gray-50 border border-gray-200 hover:bg-gray-100 px-2 py-1 rounded text-gray-700 transition"
                                >
                                    10. Cevap Yok (24s)
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.UNREACHABLE_AFTER_CALL())}
                                    className="text-xs bg-gray-50 border border-gray-200 hover:bg-gray-100 px-2 py-1 rounded text-gray-700 transition"
                                >
                                    11. Ulaşılamadı
                                </button>
                            </div>

                            <div className="text-xs font-semibold text-gray-500 border-b pb-1">Bilgi & Teslimat</div>
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.LOCATION())}
                                    className="text-xs bg-teal-50 border border-teal-200 hover:bg-teal-100 px-2 py-1 rounded text-teal-700 transition"
                                >
                                    13. Konum
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.IBAN())}
                                    className="text-xs bg-teal-50 border border-teal-200 hover:bg-teal-100 px-2 py-1 rounded text-teal-700 transition"
                                >
                                    14. IBAN
                                </button>
                                <button
                                    onClick={() => setWhatsAppMessage(WHATSAPP_TEMPLATES.DELIVERED(data.ad_soyad, data.talep_edilen_urun || 'Cihaz', data.urun_imei || '...', data.urun_seri_no || '...'))}
                                    className="text-xs bg-indigo-50 border border-indigo-200 hover:bg-indigo-100 px-2 py-1 rounded text-indigo-700 transition"
                                >
                                    15. Teslimat
                                </button>
                            </div>
                        </div>

                        <div className="flex justify-end gap-2">
                            <Button variant="ghost" onClick={() => setIsWhatsAppModalOpen(false)}>İptal</Button>
                            <Button onClick={handleSendWhatsApp} isLoading={whatsAppLoading} className="bg-green-600 hover:bg-green-700 text-white">
                                Gönder
                            </Button>
                        </div>
                    </div>
                </div>
            )}
